# æ¨¡æ¿ä½¿ç”¨æŒ‡å—

**ç‰ˆæœ¬**: 1.0  
**æ›´æ–°æ—¶é—´**: 2025-10-25

---

## ğŸ“‹ ä»€ä¹ˆæ˜¯é‚®ä»¶æ¨¡æ¿ï¼Ÿ

é‚®ä»¶æ¨¡æ¿æ˜¯é¢„å®šä¹‰çš„é‚®ä»¶æ ¼å¼ï¼Œæ”¯æŒåŠ¨æ€å˜é‡æ›¿æ¢ã€‚ä½¿ç”¨æ¨¡æ¿çš„å¥½å¤„ï¼š

- âœ… **ç»Ÿä¸€æ ¼å¼** - ä¿æŒé‚®ä»¶é£æ ¼ä¸€è‡´
- âœ… **ä¾¿äºç®¡ç†** - é›†ä¸­ç®¡ç†å’Œä¿®æ”¹
- âœ… **æ”¯æŒå˜é‡** - åŠ¨æ€æ›¿æ¢å†…å®¹
- âœ… **ç‰ˆæœ¬æ§åˆ¶** - è·Ÿè¸ªæ¨¡æ¿å˜æ›´å†å²

---

## ğŸ¨ æ¨¡æ¿è¯­æ³•

### å˜é‡æ›¿æ¢

ä½¿ç”¨ `{{variable_name}}` è¯­æ³•æ’å…¥å˜é‡ï¼š

```html
<p>å°Šæ•¬çš„ {{username}}ï¼š</p>
<p>æ‚¨çš„è®¢å• {{order_id}} å·²äº {{timestamp}} å‘è´§ã€‚</p>
```

### ç¤ºä¾‹

**æ¨¡æ¿å®šä¹‰**:
```
ä¸»é¢˜: è®¢å•é€šçŸ¥ - {{order_id}}
å†…å®¹: 
æ‚¨å¥½ {{username}}ï¼Œ
æ‚¨çš„è®¢å• {{order_id}} å·²ç¡®è®¤ã€‚
é‡‘é¢ï¼šÂ¥{{amount}}
é¢„è®¡é€è¾¾ï¼š{{delivery_date}}
```

**ä½¿ç”¨æ—¶ä¼ å…¥å˜é‡**:
```json
{
  "template_code": "order_confirm",
  "template_variables": {
    "username": "å¼ ä¸‰",
    "order_id": "ORDER-12345",
    "amount": "99.00",
    "delivery_date": "2025-10-26"
  }
}
```

**å®é™…å‘é€çš„é‚®ä»¶**:
```
ä¸»é¢˜: è®¢å•é€šçŸ¥ - ORDER-12345
å†…å®¹:
æ‚¨å¥½ å¼ ä¸‰ï¼Œ
æ‚¨çš„è®¢å• ORDER-12345 å·²ç¡®è®¤ã€‚
é‡‘é¢ï¼šÂ¥99.00
é¢„è®¡é€è¾¾ï¼š2025-10-26
```

---

## ğŸ“ åˆ›å»ºæ¨¡æ¿

### APIæ–¹å¼åˆ›å»º

**ç«¯ç‚¹**: `POST /api/v1/templates`

**è¯·æ±‚ç¤ºä¾‹**:
```python
import requests

headers = {"Authorization": f"Bearer {token}"}

payload = {
    "code": "welcome_email",
    "name": "æ¬¢è¿é‚®ä»¶",
    "channel": "email",
    "subject_template": "æ¬¢è¿åŠ å…¥ - {{app_name}}",
    "content_template": """
    <html>
    <body>
        <h1>æ¬¢è¿ï¼Œ{{username}}ï¼</h1>
        <p>æ„Ÿè°¢æ‚¨æ³¨å†Œ {{app_name}}ã€‚</p>
        <p>æ‚¨çš„è´¦å·ï¼š{{email}}</p>
        <p><a href="{{activation_link}}">ç‚¹å‡»æ¿€æ´»è´¦å·</a></p>
    </body>
    </html>
    """,
    "content_type": "html",
    "description": "ç”¨æˆ·æ³¨å†Œæ¬¢è¿é‚®ä»¶"
}

response = requests.post(
    "http://localhost:8000/api/v1/templates",
    headers=headers,
    json=payload
)
```

---

## ğŸ“š æ¨¡æ¿ç¤ºä¾‹

### 1. æ¬¢è¿é‚®ä»¶

```html
<!-- ä¸»é¢˜ -->
æ¬¢è¿åŠ å…¥ {{app_name}}

<!-- å†…å®¹ -->
<html>
<body style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
    <div style="background-color: #4CAF50; color: white; padding: 20px; text-align: center;">
        <h1>æ¬¢è¿åŠ å…¥ï¼</h1>
    </div>
    <div style="padding: 20px;">
        <p>äº²çˆ±çš„ {{username}}ï¼š</p>
        <p>æ„Ÿè°¢æ‚¨æ³¨å†Œ {{app_name}}ï¼</p>
        <p>æ‚¨çš„è´¦å·ä¿¡æ¯ï¼š</p>
        <ul>
            <li>é‚®ç®±ï¼š{{email}}</li>
            <li>æ³¨å†Œæ—¶é—´ï¼š{{register_time}}</li>
        </ul>
        <p style="text-align: center; margin: 30px 0;">
            <a href="{{activation_link}}" 
               style="background-color: #4CAF50; color: white; padding: 12px 30px; 
                      text-decoration: none; border-radius: 4px; display: inline-block;">
                æ¿€æ´»è´¦å·
            </a>
        </p>
        <p style="color: #666; font-size: 12px;">
            å¦‚æœæŒ‰é’®æ— æ³•ç‚¹å‡»ï¼Œè¯·å¤åˆ¶ä»¥ä¸‹é“¾æ¥åˆ°æµè§ˆå™¨ï¼š<br>
            {{activation_link}}
        </p>
    </div>
    <div style="background-color: #f1f1f1; padding: 10px; text-align: center; font-size: 12px;">
        <p>Â© 2025 {{app_name}}. All rights reserved.</p>
    </div>
</body>
</html>
```

**ä½¿ç”¨**:
```python
client.send_email(
    to=["newuser@example.com"],
    template_code="welcome_email",
    template_variables={
        "app_name": "æˆ‘çš„åº”ç”¨",
        "username": "å¼ ä¸‰",
        "email": "newuser@example.com",
        "register_time": "2025-10-25 18:00:00",
        "activation_link": "https://example.com/activate?token=xxx"
    }
)
```

### 2. è®¢å•ç¡®è®¤

```html
<!-- ä¸»é¢˜ -->
è®¢å•ç¡®è®¤ - {{order_id}}

<!-- å†…å®¹ -->
<html>
<body style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
    <h2>è®¢å•ç¡®è®¤</h2>
    <p>å°Šæ•¬çš„ {{customer_name}}ï¼š</p>
    <p>æ‚¨çš„è®¢å•å·²æˆåŠŸæäº¤ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š</p>
    
    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
        <tr style="background-color: #f5f5f5;">
            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">è®¢å•å·</th>
            <td style="padding: 10px; border: 1px solid #ddd;">{{order_id}}</td>
        </tr>
        <tr>
            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">ä¸‹å•æ—¶é—´</th>
            <td style="padding: 10px; border: 1px solid #ddd;">{{order_time}}</td>
        </tr>
        <tr style="background-color: #f5f5f5;">
            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">è®¢å•é‡‘é¢</th>
            <td style="padding: 10px; border: 1px solid #ddd; color: #e74c3c; font-weight: bold;">
                Â¥{{total_amount}}
            </td>
        </tr>
        <tr>
            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">æ”¶è´§åœ°å€</th>
            <td style="padding: 10px; border: 1px solid #ddd;">{{shipping_address}}</td>
        </tr>
    </table>
    
    <p>é¢„è®¡é€è¾¾æ—¶é—´ï¼š{{estimated_delivery}}</p>
    <p>å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»å®¢æœã€‚</p>
</body>
</html>
```

### 3. å¯†ç é‡ç½®

```html
<!-- ä¸»é¢˜ -->
å¯†ç é‡ç½®è¯·æ±‚ - {{app_name}}

<!-- å†…å®¹ -->
<html>
<body style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
    <h2>å¯†ç é‡ç½®</h2>
    <p>æ‚¨å¥½ {{username}}ï¼š</p>
    <p>æˆ‘ä»¬æ”¶åˆ°äº†æ‚¨çš„å¯†ç é‡ç½®è¯·æ±‚ã€‚</p>
    <p style="text-align: center; margin: 30px 0;">
        <a href="{{reset_link}}" 
           style="background-color: #3498db; color: white; padding: 12px 30px; 
                  text-decoration: none; border-radius: 4px; display: inline-block;">
            é‡ç½®å¯†ç 
        </a>
    </p>
    <p style="color: #e74c3c;">âš ï¸ æ­¤é“¾æ¥å°†åœ¨ {{expire_hours}} å°æ—¶åå¤±æ•ˆã€‚</p>
    <p style="color: #666; font-size: 12px;">
        å¦‚æœè¿™ä¸æ˜¯æ‚¨çš„æ“ä½œï¼Œè¯·å¿½ç•¥æ­¤é‚®ä»¶ã€‚
    </p>
</body>
</html>
```

### 4. æŠ¥å‘Šé€šçŸ¥

```html
<!-- ä¸»é¢˜ -->
{{report_type}}æŠ¥å‘Š - {{date}}

<!-- å†…å®¹ -->
<html>
<body style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
    <h2>{{report_type}}æŠ¥å‘Š</h2>
    <p>æŠ¥å‘Šæ—¶é—´ï¼š{{date}}</p>
    
    <h3>å…³é”®æŒ‡æ ‡</h3>
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="background-color: #3498db; color: white;">
                <th style="padding: 10px; text-align: left;">æŒ‡æ ‡</th>
                <th style="padding: 10px; text-align: right;">æ•°å€¼</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">ç”¨æˆ·æ•°</td>
                <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">
                    {{user_count}}
                </td>
            </tr>
            <tr style="background-color: #f5f5f5;">
                <td style="padding: 10px; border: 1px solid #ddd;">è®¢å•æ•°</td>
                <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">
                    {{order_count}}
                </td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">æ€»æ”¶å…¥</td>
                <td style="padding: 10px; border: 1px solid #ddd; text-align: right; 
                           color: #27ae60; font-weight: bold;">
                    Â¥{{total_revenue}}
                </td>
            </tr>
        </tbody>
    </table>
    
    <p style="margin-top: 20px;">
        è¯¦ç»†æŠ¥å‘Šè¯·æŸ¥çœ‹é™„ä»¶æˆ–è®¿é—® 
        <a href="{{report_url}}">åœ¨çº¿æŠ¥å‘Š</a>
    </p>
</body>
</html>
```

---

## ğŸ”§ æ¨¡æ¿ç®¡ç†

### æŸ¥è¯¢æ¨¡æ¿åˆ—è¡¨

```python
response = requests.get(
    "http://localhost:8000/api/v1/templates",
    headers=headers,
    params={"channel": "email", "page": 1, "page_size": 20}
)
```

### æŸ¥è¯¢å•ä¸ªæ¨¡æ¿

```python
template_id = 1
response = requests.get(
    f"http://localhost:8000/api/v1/templates/{template_id}",
    headers=headers
)
```

### æ›´æ–°æ¨¡æ¿

```python
template_id = 1
payload = {
    "subject_template": "æ–°çš„ä¸»é¢˜ - {{variable}}",
    "content_template": "æ–°çš„å†…å®¹...",
    "description": "æ›´æ–°è¯´æ˜"
}

response = requests.put(
    f"http://localhost:8000/api/v1/templates/{template_id}",
    headers=headers,
    json=payload
)
```

### åˆ é™¤æ¨¡æ¿

```python
template_id = 1
response = requests.delete(
    f"http://localhost:8000/api/v1/templates/{template_id}",
    headers=headers
)
```

---

## âœ… æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ

- **code**: ä½¿ç”¨å°å†™å­—æ¯+ä¸‹åˆ’çº¿ï¼Œå¦‚ `welcome_email`, `order_confirm`
- **name**: ä½¿ç”¨æ¸…æ™°çš„ä¸­æ–‡åç§°ï¼Œå¦‚ "æ¬¢è¿é‚®ä»¶", "è®¢å•ç¡®è®¤"

### 2. å˜é‡å‘½å

- ä½¿ç”¨å°å†™å­—æ¯+ä¸‹åˆ’çº¿
- è¯­ä¹‰åŒ–å‘½åï¼š`user_name`, `order_id`, `total_amount`
- é¿å…è¿‡äºå¤æ‚çš„åµŒå¥—

### 3. HTMLæ¨¡æ¿

- ä½¿ç”¨å†…è”æ ·å¼ï¼ˆè®¸å¤šé‚®ä»¶å®¢æˆ·ç«¯ä¸æ”¯æŒ`<style>`æ ‡ç­¾ï¼‰
- é™åˆ¶å®½åº¦åœ¨600pxå·¦å³
- ä½¿ç”¨è¡¨æ ¼å¸ƒå±€ï¼ˆæ›´å¥½çš„å…¼å®¹æ€§ï¼‰
- æä¾›çº¯æ–‡æœ¬é“¾æ¥å¤‡é€‰

### 4. æµ‹è¯•

åˆ›å»ºæ¨¡æ¿ååŠ¡å¿…æµ‹è¯•ï¼š
```python
# å‘é€æµ‹è¯•é‚®ä»¶
client.send_email(
    to=["test@example.com"],
    template_code="your_template",
    template_variables={
        "test_var": "test_value"
    }
)
```

### 5. ç‰ˆæœ¬ç®¡ç†

- é‡è¦ä¿®æ”¹å‰å…ˆå¤‡ä»½
- ä½¿ç”¨æè¿°å­—æ®µè®°å½•å˜æ›´
- æŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼ˆå¦‚æœå¯ç”¨ï¼‰

---

## ğŸ¯ å¸¸è§é—®é¢˜

### Q: å˜é‡ä¸æ›¿æ¢æ€ä¹ˆåŠï¼Ÿ

**A**: æ£€æŸ¥ï¼š
1. å˜é‡åæ˜¯å¦æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
2. æ˜¯å¦ä½¿ç”¨äº† `{{variable}}` è¯­æ³•
3. `template_variables` ä¸­æ˜¯å¦åŒ…å«è¯¥å˜é‡

### Q: HTMLæ ·å¼ä¸ç”Ÿæ•ˆï¼Ÿ

**A**: 
- ä½¿ç”¨å†…è”æ ·å¼è€Œéå¤–éƒ¨CSS
- é¿å…ä½¿ç”¨å¤æ‚çš„CSS3ç‰¹æ€§
- æµ‹è¯•ä¸åŒé‚®ä»¶å®¢æˆ·ç«¯çš„æ˜¾ç¤º

### Q: å¦‚ä½•å¤„ç†å¯é€‰å˜é‡ï¼Ÿ

**A**: åœ¨åº”ç”¨å±‚å¤„ç†ï¼š
```python
variables = {
    "username": user.name,
    "optional_field": user.optional or "é»˜è®¤å€¼"
}
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¼€å§‹æŒ‡å—](./å¿«é€Ÿå¼€å§‹æŒ‡å—.md)
- [APIè°ƒç”¨ç¤ºä¾‹](./APIè°ƒç”¨ç¤ºä¾‹.md)
- [APIå®Œæ•´æ–‡æ¡£](http://localhost:8000/docs)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-10-25

